---
layout:     post
title:      RK3399 开机日志
subtitle:   Android R(11)
date:       2022-11-22
author:     LXG
header-img: img/post-bg-android.jpg
catalog: true
tags:
    - rockchip
---

## DDR 初始化

```txt
DDR Version 1.27 20211018  // DDR bin的版本是： V1.07 对应的代码在：rkbin/bin/rk35/rk3588_ddr_lp4_2112MHz_lp5_2736MHz_v1.07.bin
In
channel 0
CS = 0
MR0=0x18
MR4=0x1
MR5=0x1
MR8=0x8
MR12=0x72
MR14=0x72
MR18=0x0
MR19=0x0
MR24=0x8
MR25=0x0
channel 1
CS = 0
MR0=0x18
MR4=0x2
MR5=0x1
MR8=0x8
MR12=0x72
MR14=0x72
MR18=0x0
MR19=0x0
MR24=0x8
MR25=0x0
channel 0 training pass!
channel 1 training pass!
change freq to 416MHz 0,1
Channel 0: LPDDR4,416MHz      // ddr类型是LPDDR4X,最高频率2112MHz
Bus Width=32 Col=10 Bank=8 Row=15 CS=1 Die Bus-Width=16 Size=1024MB   // DDR 2个通道每个通道1024MB容量，总共2G容量
Channel 1: LPDDR4,416MHz
Bus Width=32 Col=10 Bank=8 Row=15 CS=1 Die Bus-Width=16 Size=1024MB
256B stride
channel 0
CS = 0
MR0=0x18
MR4=0x1
MR5=0x1
MR8=0x8
MR12=0x72
MR14=0x72
MR18=0x0
MR19=0x0
MR24=0x8
MR25=0x0
channel 1
CS = 0
MR0=0x18
MR4=0x2
MR5=0x1
MR8=0x8
MR12=0x72
MR14=0x72
MR18=0x0
MR19=0x0
MR24=0x8
MR25=0x0
channel 0 training pass!
channel 1 training pass!
channel 0, cs 0, advanced training done
channel 1, cs 0, advanced training done
change freq to 856MHz 1,0
ch 0 ddrconfig = 0x101, ddrsize = 0x20
ch 1 ddrconfig = 0x101, ddrsize = 0x20
pmugrf_os_reg[2] = 0x3281F281, stride = 0x9
ddr_set_rate to 328MHZ
ddr_set_rate to 666MHZ
ddr_set_rate to 416MHZ, ctl_index 0
ddr_set_rate to 856MHZ, ctl_index 1
support 416 856 328 666 MHz, current 856MHz
OUT                       // DDR 初始化结束

```

## 未知

```txt

Boot1 Release Time: May 29 2020 17:36:36, version: 1.26
CPUId = 0x0
ChipType = 0x10, 346
SdmmcInit=2 0
BootCapSize=100000
UserCapSize=14910MB
FwPartOffset=2000 , 100000
mmc0:cmd8,20
mmc0:cmd5,20
mmc0:cmd55,20
mmc0:cmd1,20
mmc0:cmd8,20
mmc0:cmd5,20
mmc0:cmd55,20
mmc0:cmd1,20
mmc0:cmd8,20
mmc0:cmd5,20
mmc0:cmd55,20
mmc0:cmd1,20
SdmmcInit=0 1
StorageInit ok = 68625
SecureMode = 0
SecureInit read PBA: 0x4
SecureInit read PBA: 0x404
SecureInit read PBA: 0x804
SecureInit read PBA: 0xc04
SecureInit read PBA: 0x1004
SecureInit read PBA: 0x1404
SecureInit read PBA: 0x1804
SecureInit read PBA: 0x1c04
SecureInit ret = 0, SecureMode = 0
atags_set_bootdev: ret:(0)
GPT part:  0, name:         security, start:0x2000, size:0x2000
GPT part:  1, name:            uboot, start:0x4000, size:0x2000
GPT part:  2, name:            trust, start:0x6000, size:0x2000
GPT part:  3, name:             misc, start:0x8000, size:0x2000
GPT part:  4, name:             dtbo, start:0xa000, size:0x2000
GPT part:  5, name:           vbmeta, start:0xc000, size:0x800
GPT part:  6, name:             boot, start:0xc800, size:0x14000
GPT part:  7, name:         recovery, start:0x20800, size:0x37000
GPT part:  8, name:           backup, start:0x57800, size:0xc0000
GPT part:  9, name:            cache, start:0x117800, size:0xc0000
GPT part: 10, name:         metadata, start:0x1d7800, size:0x8000
GPT part: 11, name:    baseparameter, start:0x1df800, size:0x800
GPT part: 12, name:            super, start:0x1e0000, size:0x614000
GPT part: 13, name:         userdata, start:0x7f4000, size:0x152afdf
find part:uboot OK. first_lba:0x4000.
find part:trust OK. first_lba:0x6000.
Trust Addr:0x6000, 0x58334c42
No find bl30.bin
Load uboot, ReadLba = 4000
Load OK, addr=0x200000, size=0x10a7c0
RunBL31 0x40000 @ 115513 us
NOTICE:  BL31: v1.3(release):845ee93
NOTICE:  BL31: Built : 15:51:11, Jul 22 2020
NOTICE:  BL31: Rockchip release version: v1.1
INFO:    GICv3 with legacy support detected. ARM GICV3 driver initialized in EL3
INFO:    Using opteed sec cpu_context!
INFO:    boot cpu mask: 0
INFO:    plat_rockchip_pmu_init(1196): pd status 3e
INFO:    BL31: Initializing runtime services
INFO:    BL31: Initializing BL32
INF [0x0] TEE-CORE:init_primary_helper:337: Initializing (1.1.0-278-gef70f120a #zhangzj #9 Fri Sep 17 09:39:24 UTC 2021 aarch64)

INF [0x0] TEE-CORE:init_primary_helper:338: Release version: 1.2

INF [0x0] TEE-CORE:init_teecore:83: teecore inits done
INFO:    BL31: Preparing for EL3 exit to normal world
INFO:    Entry point address = 0x200000
INFO:    SPSR = 0x3c9

```

## Uboot

```txt


U-Boot 2017.09 (Nov 21 2022 - 16:03:38 +0800)

Model: Rockchip RK3399 Evaluation Board
PreSerial: 2, raw, 0xff1a0000
DRAM:  2 GiB
Sysmem: init
Relocation Offset: 7db71000
Relocation fdt: 7bd652c0 - 7bd67cdb
CR: M/C/I
Using default environment

DM: v1
dwmmc@fe320000: 1, sdhci@fe330000: 0
Bootdev(atags): mmc 0                  // 从emmc启动，如果是SD卡启动这里显示的是sdmmc
MMC0: HS400, 150Mhz
PartType: EFI
boot mode: None                       // 启动模式
Android 11.0, Build 2021.10, v2
Found DTB in boot part
DTB: rk-kernel.dtb                      // DTS
HASH(c): OK
ANDROID: fdt overlay OK
I2c0 speed: 100000Hz
PMIC:  RK808                            // PMIC
vdd_log 900000 uV
vdd_cpu_l 900000 uV
vdd_center 900000 uV

// 这里显示的是dts的名称，可以根据这个确认固件是否烧对
Model: Rockchip RK3399 Evaluation Board v3 (Android) LPDDR4

// 系统clk的初始化
CLK: (uboot. arml: enter 816000 KHz, init 816000 KHz, kernel 0N/A)
CLK: (uboot. armb: enter 816000 KHz, init 816000 KHz, kernel 0N/A)
  aplll 816000 KHz
  apllb 816000 KHz
  dpll 856000 KHz
  cpll 24000 KHz
  gpll 800000 KHz
  npll 600000 KHz
  vpll 24000 KHz
  aclk_perihp 133333 KHz
  hclk_perihp 66666 KHz
  pclk_perihp 33333 KHz
  aclk_perilp0 266666 KHz
  hclk_perilp0 88888 KHz
  pclk_perilp0 44444 KHz
  hclk_perilp1 100000 KHz
  pclk_perilp1 50000 KHz
Net:   eth0: ethernet@fe300000
Hit key to stop autoboot('CTRL+C'):  0

// Android固件加载并进行AVB校验，校验固件的合法性，因为这里没有开AVB校验所以可以正常开机
ANDROID: reboot reason: "(none)"
optee api revision: 2.0
TEEC: Reset area[0] info...
TEEC: Reset area[1] info...
Vboot=0, AVB images, AVB verify
read_is_device_unlocked() ops returned that device is UNLOCKED
avb_slot_verify.c:762: ERROR: vbmeta: Error verifying vbmeta image: OK_NOT_SIGNED
get image from preloaded partition...
Could not find "system" partition
Booting IMAGE kernel at 0x00280000 with fdt at 0x08300000...


// 加载kernel并跳转到kernel阶段启动
Fdt Ramdisk skip relocation
## Booting Android Image at 0x0027f800 ...
Kernel: 0x00280000 - 0x020ac010 (30897 KiB)
ramdisk:    0x0a200000 - 0x0a2cc971 (819 KiB)
## Flattened Device Tree blob at 0x08300000
   Booting using the fdt blob at 0x08300000
   XIP Kernel Image from 0x00280000 to 0x00280000 ... OK
   kernel loaded at 0x00280000, end = 0x020ac010
  'reserved-memory' ramoops@110000: addr=110000 size=f0000
   Using Device Tree in place at 0000000008300000, end 000000000831bcb9
Adding bank: 0x00200000 - 0x08400000 (size: 0x08200000)
Adding bank: 0x0a200000 - 0x80000000 (size: 0x75e00000)

Total: 735.712 ms  // 启动耗时

```

## Kernel

```txt


Starting kernel ...

[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x410fd034]

// kernel的编译信息
[    0.000000] Linux version 4.19.232 (lxg@lxg-ThinkStation-C30) (Android (6573524 based on r383902b) clang version 11.0.2 (https://android.googlesource.com/toolchain/llvm-project b397f81060ce6d701042b782172ed13bee898b79), LLD 11.0.2 (/buildbot/tmp/tmpF3FjA8 b397f81060ce6d701042b782172ed13bee898b79)) #1 SMP PREEMPT Wed Oct 26 15:32:07 CST 2022
[    0.000000] Machine model: Rockchip RK3399 Evaluation Board v3 (Android) LPDDR4
[    0.000000] earlycon: uart8250 at MMIO32 0x00000000ff1a0000 (options '')
[    0.000000] bootconsole [uart8250] enabled

```

## 内存初始化

```txt

[    0.000000] OF: fdt: Reserved memory: failed to reserve memory for node 'drm-logo@00000000': base 0x0000000000000000, size 0 MiB
[    0.000000] OF: fdt: Reserved memory: failed to reserve memory for node 'stb-devinfo@00000000': base 0x0000000000000000, size 0 MiB
[    0.000000] cma: Reserved 16 MiB at 0x000000007f000000
[    0.000000] psci: probing for conduit method from DT.
[    0.000000] psci: PSCIv1.0 detected in firmware.
[    0.000000] psci: Using standard PSCI v0.2 function IDs
[    0.000000] psci: Trusted OS migration not required
[    0.000000] psci: SMC Calling Convention v1.0
[    0.000000] percpu: Embedded 24 pages/cpu s58840 r8192 d31272 u98304
[    0.000000] Detected VIPT I-cache on CPU0
[    0.000000] CPU features: enabling workaround for ARM erratum 845719
[    0.000000] Built 1 zonelists, mobility grouping on.  Total pages: 507912
[    0.000000] Kernel command line: storagemedia=emmc androidboot.storagemedia=emmc androidboot.mode=normal  androidboot.dtb_idx=0 androidboot.dtbo_idx=0  androidboot.verifiedbootstate=orange androidboot.serialno=RXM721000001111W console=ttyFIQ0 androidboot.baseband=N/A androidboot.wificountrycode=CN androidboot.veritymode=enforcing androidboot.hardware=rk30board androidboot.console=ttyFIQ0 androidboot.verifiedbootstate=orange firmware_class.path=/vendor/etc/firmware init=/init rootwait ro loop.max_part=7 buildvariant=userdebug earlycon=uart8250,mmio32,0xff1a0000 coherent_pool=1m androidboot.boot_devices=fe330000.sdhci
[    0.000000] Dentry cache hash table entries: 262144 (order: 9, 2097152 bytes)
[    0.000000] Inode-cache hash table entries: 131072 (order: 8, 1048576 bytes)
[    0.000000] mem auto-init: stack:off, heap alloc:off, heap free:off
[    0.000000] Memory: 1977656K/2064384K available (15678K kernel code, 2098K rwdata, 9120K rodata, 3968K init, 941K bss, 70344K reserved, 16384K cma-reserved)
[    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=6, Nodes=1
[    0.000000] rcu: Preemptible hierarchical RCU implementation.
[    0.000000] rcu:     RCU restricting CPUs from NR_CPUS=8 to nr_cpu_ids=6.
[    0.000000]  Tasks RCU enabled.
[    0.000000] rcu: Adjusting geometry for rcu_fanout_leaf=16, nr_cpu_ids=6
[    0.000000] NR_IRQS: 64, nr_irqs: 64, preallocated irqs: 0
[    0.000000] GICv3: GIC: Using split EOI/Deactivate mode
[    0.000000] GICv3: Distributor has no Range Selector support
[    0.000000] GICv3: no VLPI support, no direct LPI support
[    0.000000] ITS [mem 0xfee20000-0xfee3ffff]
[    0.000000] ITS@0x00000000fee20000: allocated 65536 Devices @a300000 (flat, esz 8, psz 64K, shr 0)
[    0.000000] ITS: using cache flushing for cmd queue
[    0.000000] GIC: using LPI property table @0x0000000000270000
[    0.000000] GICv3: CPU0: found redistributor 0 region 0:0x00000000fef00000
[    0.000000] CPU0: using LPI pending table @0x000000000a380000
[    0.000000] GIC: using cache flushing for LPI property table
[    0.000000] GICv3: GIC: PPI partition interrupt-partition-0[0] { /cpus/cpu@0[0] /cpus/cpu@1[1] /cpus/cpu@2[2] /cpus/cpu@3[3] }
[    0.000000] GICv3: GIC: PPI partition interrupt-partition-1[1] { /cpus/cpu@100[4] /cpus/cpu@101[5] }
[    0.000000] random: random: get_random_bytes called from start_kernel+0x22c/0x3d0 with crng_init=0
[    0.000000] rockchip_clk_register_frac_branch: could not find dclk_vop0_frac as parent of dclk_vop0, rate changes may not work
[    0.000000] rockchip_clk_register_frac_branch: could not find dclk_vop1_frac as parent of dclk_vop1, rate changes may not work
[    0.000000] arch_timer: cp15 timer(s) running at 24.00MHz (phys).
[    0.000000] clocksource: arch_sys_counter: mask: 0xffffffffffffff max_cycles: 0x588fe9dc0, max_idle_ns: 440795202592 ns
[    0.000006] sched_clock: 56 bits at 24MHz, resolution 41ns, wraps every 4398046511097ns
[    0.001834] Calibrating delay loop (skipped), value calculated using timer frequency.. 48.00 BogoMIPS (lpj=80000)
[    0.002750] pid_max: default: 32768 minimum: 301
[    0.003282] Security Framework initialized
[    0.003653] SELinux:  Initializing.
[    0.004065] Mount-cache hash table entries: 4096 (order: 3, 32768 bytes)
[    0.004668] Mountpoint-cache hash table entries: 4096 (order: 3, 32768 bytes)
[    0.006938] ASID allocator initialised with 32768 entries
[    0.007527] rcu: Hierarchical SRCU implementation.
[    0.008387] Platform MSI: interrupt-controller@fee20000 domain created
[    0.009467] PCI/MSI: /interrupt-controller@fee00000/interrupt-controller@fee20000 domain created

```

## CPU 初始化

```txt

[    0.010990] smp: Bringing up secondary CPUs ...
[    0.012040] Detected VIPT I-cache on CPU1
[    0.012076] GICv3: CPU1: found redistributor 1 region 0:0x00000000fef20000
[    0.012120] CPU1: using LPI pending table @0x000000007c110000
[    0.012173] CPU1: Booted secondary processor 0x0000000001 [0x410fd034]
[    0.013068] Detected VIPT I-cache on CPU2
[    0.013102] GICv3: CPU2: found redistributor 2 region 0:0x00000000fef40000
[    0.013146] CPU2: using LPI pending table @0x000000007c160000
[    0.013197] CPU2: Booted secondary processor 0x0000000002 [0x410fd034]
[    0.014036] Detected VIPT I-cache on CPU3
[    0.014071] GICv3: CPU3: found redistributor 3 region 0:0x00000000fef60000
[    0.014115] CPU3: using LPI pending table @0x000000007c190000
[    0.014166] CPU3: Booted secondary processor 0x0000000003 [0x410fd034]
[    0.015033] ARM_SMCCC_ARCH_WORKAROUND_1 missing from firmware
[    0.015039] CPU features: enabling workaround for EL2 vector hardening
[    0.015047] Detected PIPT I-cache on CPU4
[    0.015071] GICv3: CPU4: found redistributor 100 region 0:0x00000000fef80000
[    0.015126] CPU4: using LPI pending table @0x000000007c1e0000
[    0.015159] CPU4: Booted secondary processor 0x0000000100 [0x410fd082]
[    0.015888] Detected PIPT I-cache on CPU5
[    0.015914] GICv3: CPU5: found redistributor 101 region 0:0x00000000fefa0000
[    0.015970] CPU5: using LPI pending table @0x000000007c1f0000
[    0.016003] CPU5: Booted secondary processor 0x0000000101 [0x410fd082]
[    0.016110] smp: Brought up 1 node, 6 CPUs
[    0.027838] SMP: Total of 6 processors activated.
[    0.028259] CPU features: detected: GIC system register CPU interface
[    0.028832] CPU features: detected: 32-bit EL0 Support
[    0.035811] CPU features: emulated: Privileged Access Never (PAN) using TTBR0_EL1 switching
[    0.036569] CPU: All CPU(s) started at EL2

```

## 未知

```txt

[    0.036970] alternatives: patching kernel code
[    0.039036] devtmpfs: initialized
[    0.052541] Trying to unpack rootfs image as initramfs...
[    0.053070] Registered cp15_barrier emulation handler
[    0.053082] Registered setend emulation handler
[    0.053450] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 6370867519511994 ns
[    0.054930] futex hash table entries: 2048 (order: 5, 131072 bytes)
[    0.055908] pinctrl core: initialized pinctrl subsystem
[    0.057089] NET: Registered protocol family 16
[    0.057918] schedtune: configured to support 6 boost groups
[    0.058672] audit: initializing netlink subsys (disabled)
[    0.060092] audit: type=2000 audit(0.059:1): state=initialized audit_enabled=0 res=1
[    0.061443] cpuidle: using governor menu
[    0.061818] Registered FIQ tty driver
[    0.062615] hw-breakpoint: found 6 breakpoint and 4 watchpoint registers.
[    0.074149] DMA: preallocated 1024 KiB pool for atomic allocations
[    0.076812] console [pstore-1] enabled
[    0.077308] pstore: Registered ramoops as persistent store backend
[    0.077905] ramoops: attached 0xf0000@0x110000, ecc: 0/0
[    0.094966] rockchip-gpio ff720000.gpio0: probed gpio0 (ff720000.gpio0)
[    0.095966] rockchip-gpio ff730000.gpio1: probed gpio1 (ff730000.gpio1)
[    0.096572] Freeing initrd memory: 816K
[    0.097070] rockchip-gpio ff780000.gpio2: probed gpio2 (ff780000.gpio2)
[    0.098052] rockchip-gpio ff788000.gpio3: probed gpio3 (ff788000.gpio3)
[    0.099015] rockchip-gpio ff790000.gpio4: probed gpio4 (ff790000.gpio4)
[    0.099717] rockchip-pinctrl pinctrl: probed pinctrl
[    0.108913] cryptd: max_cpu_qlen set to 1000
[    0.110324] fiq debugger fiq mode enabled
[[    0.110934] console [ttyFIQ0] enabled
    0.110934] console [ttyFIQ0] enabled
[    0.111614] bootconsole [uart8250] disabled
[    0.111614] bootconsole [uart8250] disabled
[    0.112154] Registered fiq debugger ttyFIQ0
[    0.113545] rk_iommu ff650800.iommu: version = 1
[    0.113916] rk_iommu ff660480.iommu: version = 1
[    0.114170] rk_iommu ff670800.iommu: version = 1
[    0.114431] rk_iommu ff8f3f00.iommu: version = 1
[    0.114633] rk_iommu ff903f00.iommu: version = 1
[    0.115076] SCSI subsystem initialized
[    0.115246] usbcore: registered new interface driver usbfs
[    0.115291] usbcore: registered new interface driver hub
[    0.115332] usbcore: registered new device driver usb
[    0.115554] media: Linux media interface: v0.10
[    0.115585] videodev: Linux video capture interface: v2.00
[    0.115642] pps_core: LinuxPPS API ver. 1 registered
[    0.115656] pps_core: Software ver. 5.3.6 - Copyright 2005-2007 Rodolfo Giometti <giometti@linux.it>
[    0.115676] PTP clock support registered
[    0.117386] Advanced Linux Sound Architecture Driver Initialized.
[    0.117715] Bluetooth: Core ver 2.22
[    0.117752] NET: Registered protocol family 31
[    0.117766] Bluetooth: HCI device and connection manager initialized
[    0.117783] Bluetooth: HCI socket layer initialized
[    0.117797] Bluetooth: L2CAP socket layer initialized
[    0.117825] Bluetooth: SCO socket layer initialized
[    0.118219] rockchip-cpuinfo cpuinfo: SoC            : 0
[    0.118237] rockchip-cpuinfo cpuinfo: Serial         : a766a72b2b97f750
[    0.118641] clocksource: Switched to clocksource arch_sys_counter
[    0.176633] VFS: Disk quotas dquot_6.6.0
[    0.176708] VFS: Dquot-cache hash table entries: 512 (order 0, 4096 bytes)
[    0.177925] thermal thermal_zone1: power_allocator: sustainable_power will be estimated
[    0.178155] NET: Registered protocol family 2
[    0.178327] IP idents hash table entries: 32768 (order: 6, 262144 bytes)
[    0.179505] tcp_listen_portaddr_hash hash table entries: 1024 (order: 2, 16384 bytes)
[    0.179556] TCP established hash table entries: 16384 (order: 5, 131072 bytes)
[    0.179695] TCP bind hash table entries: 16384 (order: 6, 262144 bytes)
[    0.179968] TCP: Hash tables configured (established 16384 bind 16384)
[    0.180069] UDP hash table entries: 1024 (order: 3, 32768 bytes)
[    0.180144] UDP-Lite hash table entries: 1024 (order: 3, 32768 bytes)
[    0.180289] NET: Registered protocol family 1
[    0.182087] hw perfevents: enabled with armv8_cortex_a53 PMU driver, 7 counters available
[    0.182371] hw perfevents: enabled with armv8_cortex_a72 PMU driver, 7 counters available
[    0.183718] Initialise system trusted keyrings
[    0.183888] workingset: timestamp_bits=45 max_order=19 bucket_order=0
[    0.187917] utf8_selftest: All 154 tests passed
[    0.187938] fuse init (API version 7.27)
[    0.189044]
[    0.189044] TEE Core Framework initialization (ver 1:0.1)
[    0.189070] TEE armv7 Driver initialization
[    0.189416] tz_tee_probe: name="armv7sec", id=0, pdev_name="armv7sec.0"
[    0.189435] TEE core: Alloc the misc device "opteearmtz00" (id=0)
[    0.189587] TEE Core: Register the misc device "opteearmtz00" (id=0,minor=62)
[    0.190623] Key type asymmetric registered
[    0.190639] Asymmetric key parser 'x509' registered
[    0.190672] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 243)
[    0.190687] io scheduler noop registered
[    0.190788] io scheduler cfq registered (default)
[    0.190802] io scheduler mq-deadline registered
[    0.190814] io scheduler kyber registered
[    0.190888] io scheduler bfq registered
[    0.195606] pwm-backlight backlight: backlight supply power not found, using dummy regulator
[    0.195683] pwm-backlight backlight: Linked as a consumer to regulator.0
[    0.195949] iommu: Adding device ff670000.iep to group 2
[    0.195976] iep ff670000.iep: Linked as a consumer to ff670800.iommu
[    0.196138] iep: failed to find iep power down clock source.
[    0.196450] iep: IEP Power ON
[    0.196486] iep: IEP Power OFF
[    0.196556] iep: IEP Driver loaded succesfully
[    0.196697] iep: Module initialized.
[    0.196819] mpp_service mpp-srv: 0460c6f author: xiaogang.li 2022-10-14 init 6
[    0.196834] mpp_service mpp-srv: probe start
[    0.197187] iommu: Adding device ff660000.rkvdec to group 1
[    0.197215] mpp_rkvdec ff660000.rkvdec: Linked as a consumer to ff660480.iommu
[    0.197388] mpp_rkvdec ff660000.rkvdec: probing start
[    0.197737] rkvdec_init:1222: failed on clk_get clk_hevc_cabac
[    0.197798] mpp_rkvdec ff660000.rkvdec: shared_video_hevc_cabac is not found!
[    0.197811] rkvdec_init:1253: No hevc cabac reset resource define
[    0.197943] mpp_rkvdec ff660000.rkvdec: probing finish
[    0.198800] iommu: Adding device ff650400.vdpu to group 0
[    0.198828] mpp_vdpu2 ff650400.vdpu: Linked as a consumer to ff650800.iommu
[    0.199001] mpp_vdpu2 ff650400.vdpu: probe device
[    0.199290] mpp_vdpu2 ff650400.vdpu: reset_group->rw_sem_on=0
[    0.199312] mpp_vdpu2 ff650400.vdpu: reset_group->rw_sem_on=0
[    0.199446] mpp_vdpu2 ff650400.vdpu: probing finish
[    0.199766] iommu: Adding device ff650000.vepu to group 0
[    0.199793] mpp_vepu2 ff650000.vepu: Linked as a consumer to ff650800.iommu
[    0.199836] mpp_vepu2 ff650000.vepu: probe device
[    0.200096] mpp_vepu2 ff650000.vepu: reset_group->rw_sem_on=0
[    0.200114] mpp_vepu2 ff650000.vepu: reset_group->rw_sem_on=0
[    0.200230] mpp_vepu2 ff650000.vepu: probing finish
[    0.200823] mpp_service mpp-srv: probe success
[    0.203462] dma-pl330 ff6d0000.dma-controller: Loaded driver for PL330 DMAC-241330
[    0.203484] dma-pl330 ff6d0000.dma-controller:       DBUFF-32x8bytes Num_Chans-6 Num_Peri-12 Num_Events-12
[    0.204519] dma-pl330 ff6e0000.dma-controller: Loaded driver for PL330 DMAC-241330
[    0.204540] dma-pl330 ff6e0000.dma-controller:       DBUFF-128x8bytes Num_Chans-8 Num_Peri-20 Num_Events-16
[    0.205234] rockchip-system-monitor rockchip-system-monitor: system monitor probe
[    0.205606] vdd_center: supplied by regulator-dummy
[    0.206266] Serial: 8250/16550 driver, 10 ports, IRQ sharing disabled
[    0.206777] ff180000.serial: ttyS0 at MMIO 0xff180000 (irq = 35, base_baud = 1500000) is a 16550A
[    0.208341] iommu: Adding device ff8f0000.vop to group 3
[    0.208374] rockchip-vop ff8f0000.vop: Linked as a consumer to ff8f3f00.iommu
[    0.208399] random: fast init done
[    0.208716] iommu: Adding device ff900000.vop to group 4
[    0.208726] random: crng init done
[    0.208772] rockchip-vop ff900000.vop: Linked as a consumer to ff903f00.iommu
[    0.211517] rockchip-drm display-subsystem: Linked as a consumer to ff8f0000.vop
[    0.211546] rockchip-drm display-subsystem: Linked as a consumer to ff900000.vop
[    0.212141] rockchip-drm display-subsystem: Linked as a consumer to ff970000.edp
[    0.212511] rockchip-drm display-subsystem: Linked as a consumer to ff940000.hdmi
[    0.217718] midgard ff9a0000.gpu: Failed to get regulator
[    0.217738] midgard ff9a0000.gpu: Power control initialization failed
[    0.218136] cacheinfo: Unable to detect cache hierarchy for CPU 0
[    0.223805] brd: module loaded
[    0.235852] loop: module loaded
[    0.236188] zram: Added device: zram0
[    0.236487] SCSI Media Changer driver v0.25
[    0.238398] tun: Universal TUN/TAP device driver, 1.6
[    0.239025] rk_gmac-dwmac fe300000.ethernet: PTP uses main clock
[    0.239101] rk_gmac-dwmac fe300000.ethernet: Linked as a consumer to regulator.3
[    0.239119] rk_gmac-dwmac fe300000.ethernet: clock input or output? (input).
[    0.239133] rk_gmac-dwmac fe300000.ethernet: TX delay(0x28).
[    0.239147] rk_gmac-dwmac fe300000.ethernet: RX delay(0x11).
[    0.239163] rk_gmac-dwmac fe300000.ethernet: integrated PHY? (no).
[    0.239208] rk_gmac-dwmac fe300000.ethernet: cannot get clock clk_mac_speed
[    0.239221] rk_gmac-dwmac fe300000.ethernet: clock input from PHY
[    0.244239] rk_gmac-dwmac fe300000.ethernet: init for RGMII
[    0.244417] rk_gmac-dwmac fe300000.ethernet: User ID: 0x10, Synopsys ID: 0x35
[    0.244436] rk_gmac-dwmac fe300000.ethernet:         DWMAC1000
[    0.244450] rk_gmac-dwmac fe300000.ethernet: DMA HW capability register supported
[    0.244463] rk_gmac-dwmac fe300000.ethernet: RX Checksum Offload Engine supported
[    0.244476] rk_gmac-dwmac fe300000.ethernet: COE Type 2
[    0.244489] rk_gmac-dwmac fe300000.ethernet: TX Checksum insertion supported
[    0.244501] rk_gmac-dwmac fe300000.ethernet: Wake-Up On Lan supported
[    0.244536] rk_gmac-dwmac fe300000.ethernet: Normal descriptors
[    0.244550] rk_gmac-dwmac fe300000.ethernet: Ring mode enabled
[    0.244562] rk_gmac-dwmac fe300000.ethernet: Enable RX Mitigation via HW Watchdog Timer
[    0.322736] mdio_bus stmmac-0:00: attached PHY driver [unbound] (mii_bus:phy_addr=stmmac-0:00, irq=POLL)
[    0.322754] mdio_bus stmmac-0:01: attached PHY driver [unbound] (mii_bus:phy_addr=stmmac-0:01, irq=POLL)
[    0.323412] PPP generic driver version 2.4.2
[    0.323580] PPP BSD Compression module registered
[    0.323595] PPP Deflate Compression module registered
[    0.323633] PPP MPPE Compression module registered
[    0.323646] NET: Registered protocol family 24
[    0.323669] PPTP driver version 0.8.5
[    0.323954] SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256) (6 bit encapsulation enabled).
[    0.323966] CSLIP: code copyright 1989 Regents of the University of California.
[    0.324036] usbcore: registered new interface driver catc
[    0.324073] usbcore: registered new interface driver kaweth
[    0.324086] pegasus: v0.9.3 (2013/04/25), Pegasus/Pegasus II USB Ethernet driver
[    0.324120] usbcore: registered new interface driver pegasus
[    0.324155] usbcore: registered new interface driver rtl8150
[    0.324200] usbcore: registered new interface driver r8152
[    0.324212] hso: drivers/net/usb/hso.c: Option Wireless
[    0.324260] usbcore: registered new interface driver hso
[    0.324297] usbcore: registered new interface driver asix
[    0.324332] usbcore: registered new interface driver ax88179_178a
[    0.324369] usbcore: registered new interface driver cdc_ether
[    0.324404] usbcore: registered new interface driver cdc_eem
[    0.324438] usbcore: registered new interface driver dm9601
[    0.324477] usbcore: registered new interface driver smsc75xx
[    0.324522] usbcore: registered new interface driver smsc95xx
[    0.324556] usbcore: registered new interface driver gl620a
[    0.324591] usbcore: registered new interface driver net1080
[    0.324625] usbcore: registered new interface driver plusb
[    0.324660] usbcore: registered new interface driver rndis_host
[    0.324697] usbcore: registered new interface driver cdc_subset
[    0.324726] usbcore: registered new interface driver zaurus
[    0.324764] usbcore: registered new interface driver MOSCHIP usb-ethernet driver
[    0.324803] usbcore: registered new interface driver int51x1
[    0.324837] usbcore: registered new interface driver kalmia
[    0.324873] usbcore: registered new interface driver ipheth
[    0.324908] usbcore: registered new interface driver sierra_net
[    0.324944] usbcore: registered new interface driver cx82310_eth
[    0.324979] usbcore: registered new interface driver cdc_ncm
[    0.325015] usbcore: registered new interface driver qmi_wwan
[    0.325051] usbcore: registered new interface driver cdc_mbim
[    0.325963] dwc3 fe800000.dwc3: Failed to get clk 'ref': -2
[    0.326864] dwc3 fe900000.dwc3: Failed to get clk 'ref': -2
[    0.327997] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
[    0.328014] ehci-pci: EHCI PCI platform driver
[    0.328073] ehci-platform: EHCI generic platform driver
[    0.328500] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver
[    0.328523] ohci-platform: OHCI generic platform driver
[    0.329281] usbcore: registered new interface driver cdc_acm
[    0.329296] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters
[    0.329341] usbcore: registered new interface driver usblp
[    0.329378] usbcore: registered new interface driver cdc_wdm
[    0.329581] usbcore: registered new interface driver uas
[    0.329639] usbcore: registered new interface driver usb-storage
[    0.329674] usbcore: registered new interface driver ums-alauda
[    0.329708] usbcore: registered new interface driver ums-cypress
[    0.329747] usbcore: registered new interface driver ums-datafab
[    0.329778] usbcore: registered new interface driver ums_eneub6250
[    0.329815] usbcore: registered new interface driver ums-freecom
[    0.329849] usbcore: registered new interface driver ums-isd200
[    0.329884] usbcore: registered new interface driver ums-jumpshot
[    0.329918] usbcore: registered new interface driver ums-karma
[    0.329952] usbcore: registered new interface driver ums-onetouch
[    0.329985] usbcore: registered new interface driver ums-sddr09
[    0.330015] usbcore: registered new interface driver ums-sddr55
[    0.330049] usbcore: registered new interface driver ums-usbat
[    0.330118] usbcore: registered new interface driver usbserial_generic
[    0.330144] usbserial: USB Serial support registered for generic
[    0.330179] usbcore: registered new interface driver option
[    0.330204] usbserial: USB Serial support registered for GSM modem (1-port)
[    0.330242] usbcore: registered new interface driver trancevibrator
[    0.330561] usbcore: registered new interface driver xpad
[    0.330603] usbcore: registered new interface driver usb_acecad
[    0.330639] usbcore: registered new interface driver aiptek
[    0.330674] usbcore: registered new interface driver gtco
[    0.330712] usbcore: registered new interface driver hanwang
[    0.330743] usbcore: registered new interface driver kbtab
[    0.331074] cyttsp5_loader_init: Parade TTSP FW Loader Driver (Built TTDA.03.08.874312) rc=0
[    0.331097] cyttsp5_device_access_init: Parade TTSP Device Access Driver (Built TTDA.03.08.874312) rc=0
[    0.332558] i2c /dev entries driver
[    0.334388] fusb302 6-0022: Can't get property of role, set role to default DRP
[    0.337558] fusb302 6-0022: port 0 probe success with role ROLE_MODE_DRP, try_role ROLE_MODE_NONE
[    0.337713] input: Typec_Headphone as /devices/platform/ff150000.i2c/i2c-6/6-0022/input/input0
[    0.339038] fusb302 0-0022: Can't get property of role, set role to default DRP
[    0.342128] fusb302 0-0022: port 1 probe success with role ROLE_MODE_DRP, try_role ROLE_MODE_NONE
[    0.342276] input: Typec_Headphone as /devices/platform/ff3c0000.i2c/i2c-0/0-0022/input/input1

```

## PMIC 电源初始化

```txt

[    0.343636] fan53555-regulator 0-0040: FAN53555 Option[8] Rev[1] Detected!
[    0.345735] vdd_cpu_b: supplied by vcc5v0_sys
[    0.349631] fan53555-regulator 0-0041: FAN53555 Option[8] Rev[1] Detected!
[    0.351706] vdd_gpu: supplied by vcc5v0_sys
[    0.355585] rk808 0-001b: chip id: 0x0
[    0.365580] rk808-regulator rk808-regulator: there is no dvs0 gpio
[    0.365621] rk808-regulator rk808-regulator: there is no dvs1 gpio
[    0.367755] vdd_log: supplied by vcc3v3_sys
[    0.369713] vdd_cpu_l: supplied by vcc3v3_sys
[    0.370024] vcc_ddr: supplied by vcc3v3_sys
[    0.371237] vcc_1v8: supplied by vcc3v3_sys
[    0.372798] vcc1v8_dvp: supplied by vcc3v3_sys
[    0.374350] vcc3v0_tp: supplied by vcc3v3_sys
[    0.375907] vcc1v8_pmu: supplied by vcc3v3_sys
[    0.377486] vcc_sd: supplied by vcc3v3_sys
[    0.378571] vcca3v0_codec: supplied by vcc3v3_sys
[    0.380161] vcc_1v5: supplied by vcc3v3_sys
[    0.381262] vcca1v8_codec: supplied by vcc3v3_sys
[    0.382832] vcc_3v0: supplied by vcc3v3_sys
[    0.383121] vcc3v3_s3: supplied by vcc3v3_sys
[    0.383756] vcc3v3_s0: supplied by vcc3v3_sys
[    0.392851] rk808-rtc rk808-rtc: registered as rtc0
[    0.394581] rk808-rtc rk808-rtc: setting system clock to 2013-01-18 08:50:03 UTC (1358499003)

```

## CPU 变频

CPU频率及变频初始化 ,注意在这之前需要需要先完成RK806电源部分的初始化，否则CPU变频会异常

```txt

[    0.395554] input: gsl3673 as /devices/platform/ff3d0000.i2c/i2c-4/4-0040/input/input2
[    0.468806] gsl3673 4-0040: GSL3673 test_i2c error!
[    0.468823] gsl3673 4-0040: gsl_probe: init_chip failed
[    0.469067] gsl3673: probe of 4-0040 failed with error -1
[    0.470881] usbcore: registered new interface driver uvcvideo
[    0.470895] USB Video Class driver (1.1.1)
[    0.471131] rockchip-iodomain ff320000.syscon:io-domains: Linked as a consumer to regulator.14
[    0.471163] rockchip-iodomain ff320000.syscon:io-domains: pmu1830(1800000 uV) supplied by vcc1v8_pmu
[    0.471331] rockchip-iodomain ff770000.syscon:io-domains: Linked as a consumer to regulator.12
[    0.471359] rockchip-iodomain ff770000.syscon:io-domains: bt656(1800000 uV) supplied by vcc1v8_dvp
[    0.471440] rockchip-iodomain ff770000.syscon:io-domains: Linked as a consumer to regulator.18
[    0.471468] rockchip-iodomain ff770000.syscon:io-domains: audio(1800000 uV) supplied by vcca1v8_codec
[    0.471534] rockchip-iodomain ff770000.syscon:io-domains: Linked as a consumer to regulator.15
[    0.471561] rockchip-iodomain ff770000.syscon:io-domains: sdmmc(3000000 uV) supplied by vcc_sd
[    0.471624] rockchip-iodomain ff770000.syscon:io-domains: Linked as a consumer to regulator.19
[    0.471649] rockchip-iodomain ff770000.syscon:io-domains: gpio1830(3000000 uV) supplied by vcc_3v0
[    0.472304] __power_supply_register: Expected proper parent device for 'test_ac'
[    0.472444] __power_supply_register: Expected proper parent device for 'test_battery'
[    0.472655] thermal thermal_zone2: power_allocator: sustainable_power will be estimated
[    0.472732] __power_supply_register: Expected proper parent device for 'test_usb'
[    0.473899] rockchip-thermal ff260000.tsadc: tsadc is probed successfully!
[    0.474746] device-mapper: uevent: version 1.0.3
[    0.474931] device-mapper: ioctl: 4.39.0-ioctl (2018-04-03) initialised: dm-devel@redhat.com
[    0.475088] device-mapper: verity-avb: AVB error handler initialized with vbmeta device:
[    0.475108] Bluetooth: HCI UART driver ver 2.3
[    0.475121] Bluetooth: HCI UART protocol H4 registered
[    0.475336] cpu cpu0: bin=1
[    0.475371] cpu cpu0: leakage=15
[    0.475451] cpu cpu0: Linked as a consumer to regulator.9
[    0.488166] cpu cpu0: temp=32777, pvtm=144233 (145268 + -1035)
[    0.488597] cpu cpu0: Dropping the link to regulator.9
[    0.488658] cpu cpu0: pvtm-volt-sel=1
[    0.488682] cpu cpu0: bin-scale=34
[    0.488745] cpu cpu4: bin=1
[    0.488771] cpu cpu4: leakage=26
[    0.488838] cpu cpu4: Linked as a consumer to regulator.6
[    0.501702] cpu cpu4: temp=32777, pvtm=153495 (154134 + -639)
[    0.501807] cpu cpu4: Dropping the link to regulator.6
[    0.501844] cpu cpu4: pvtm-volt-sel=1
[    0.501865] cpu cpu4: bin-scale=17
[    0.502137] cpu cpu0: Linked as a consumer to regulator.9
[    0.502180] cpu cpu0: Dropping the link to regulator.9
[    0.502292] cpu cpu0: Linked as a consumer to regulator.9
[    0.502759] cpu cpu0: avs=0
[    0.502957] cpu cpu0: l=0 h=2147483647 hyst=5000 l_limit=0 h_limit=0 h_table=0
[    0.503505] cpu cpu0: failed to find power_model node
[    0.503625] cpu cpu4: Linked as a consumer to regulator.6
[    0.504203] cpu cpu4: avs=0
[    0.504246] energy_model: pd4: hertz/watts ratio non-monotonically decreasing: em_cap_state 2 >= em_cap_state1
[    0.504436] cpu cpu4: l=0 h=2147483647 hyst=5000 l_limit=0 h_limit=0 h_table=0
[    0.507813] cpu cpu4: failed to find power_model node
[    0.509059] sdhci: Secure Digital Host Controller Interface driver
[    0.509083] sdhci: Copyright(c) Pierre Ossman
[    0.509091] Synopsys Designware Multimedia Card Interface Driver
[    0.509727] dwmmc_rockchip fe310000.dwmmc: IDMAC supports 32-bit address mode.
[    0.510119] dwmmc_rockchip fe310000.dwmmc: Using internal DMA controller.
[    0.510152] dwmmc_rockchip fe310000.dwmmc: Version ID is 270a
[    0.510224] dwmmc_rockchip fe310000.dwmmc: DW MMC controller at irq 25,32 bit host data width,256 deep fifo
[    0.510378] dwmmc_rockchip fe310000.dwmmc: allocated mmc-pwrseq
[    0.510400] mmc_host mmc0: card is non-removable.
[    0.524312] mmc_host mmc0: Bus speed (slot 0) = 400000Hz (slot req 400000Hz, actual 400000HZ div = 0)
[    0.538115] dwmmc_rockchip fe320000.dwmmc: IDMAC supports 32-bit address mode.
[    0.538405] dwmmc_rockchip fe320000.dwmmc: Using internal DMA controller.
[    0.538432] dwmmc_rockchip fe320000.dwmmc: Version ID is 270a
[    0.538495] dwmmc_rockchip fe320000.dwmmc: DW MMC controller at irq 26,32 bit host data width,256 deep fifo
[    0.539578] dwmmc_rockchip fe320000.dwmmc: Linked as a consumer to regulator.15
[    0.542416] vcc_sd: unsupportable voltage range: 3300000-3000000uV
[    0.544753] dwmmc_rockchip fe310000.dwmmc: card claims to support voltages below defined range
[    0.555293] mmc_host mmc1: Bus speed (slot 0) = 400000Hz (slot req 400000Hz, actual 400000HZ div = 0)
[    0.569191] sdhci-pltfm: SDHCI platform and OF driver helper
[    0.576422] mmc_host mmc0: Bus speed (slot 0) = 100000000Hz (slot req 100000000Hz, actual 100000000HZ div = 0)
[    0.596756] dwmmc_rockchip fe310000.dwmmc: Successfully tuned phase to 145
[    0.597095] mmc2: SDHCI controller on fe330000.sdhci [fe330000.sdhci] using ADMA
[    0.597928] mmc0: new ultra high speed SDR50 SDIO card at address 0001
[    0.598256] cryptodev: driver 1.12 loaded.
[    0.598296] hidraw: raw HID events driver (C) Jiri Kosina
[    0.600256] usbcore: registered new interface driver usbhid
[    0.600267] usbhid: USB HID core driver
[    0.600320] ion_device_add_heap: ion_system_contig_heap id=0 type=1
[    0.600518] ion_device_add_heap: ion_system_heap id=1 type=0
[    0.600534] ion_device_add_heap: reserved id=2 type=4
[    0.600789] ashmem: initialized
[    0.603407] rockchip-saradc ff100000.saradc: Linked as a consumer to regulator.11
[    0.604187] optee: probing for conduit method from DT.
[    0.604213] optee: revision 1.1
[    0.604559] optee: initialized driver
[    0.604574] rknandbase v1.2 2021-01-07
[    0.604956] usbcore: registered new interface driver snd-usb-audio
[    0.614896] netem: version 1.3
[    0.614939] u32 classifier
[    0.614954]     Actions configured
[    0.615895] xt_time: kernel timezone is -0000
[    0.616007] gre: GRE over IPv4 demultiplexor driver
[    0.616022] IPv4 over IPsec tunneling driver
[    0.616619] Initializing XFRM netlink socket
[    0.616640] IPsec XFRM device driver
[    0.616911] NET: Registered protocol family 10
[    0.617702] Segment Routing with IPv6
[    0.617770] mip6: Mobile IPv6
[    0.618245] sit: IPv6, IPv4 and MPLS over IPv4 tunneling driver
[    0.618864] NET: Registered protocol family 17
[    0.618886] NET: Registered protocol family 15
[    0.618935] Bridge firewalling registered

```

## Bluetooth Wlan

```txt

[    0.619304] Bluetooth: RFCOMM TTY layer initialized
[    0.619344] Bluetooth: RFCOMM socket layer initialized
[    0.619373] Bluetooth: RFCOMM ver 1.11
[    0.619393] Bluetooth: BNEP (Ethernet Emulation) ver 1.3
[    0.619402] Bluetooth: BNEP filters: protocol multicast
[    0.619414] Bluetooth: BNEP socket layer initialized
[    0.619423] Bluetooth: HIDP (Human Interface Emulation) ver 1.2
[    0.619434] Bluetooth: HIDP socket layer initialized
[    0.619461] l2tp_core: L2TP core driver, V2.0
[    0.619472] l2tp_ppp: PPPoL2TP kernel driver, V2.0
[    0.619478] [BT_RFKILL]: Enter rfkill_rk_init
[    0.619484] [WLAN_RFKILL]: Enter rfkill_wlan_init
[    0.619819] [WLAN_RFKILL]: Enter rfkill_wlan_probe
[    0.619860] [WLAN_RFKILL]: wlan_platdata_parse_dt: wifi_chip_type = ap6354
[    0.619868] [WLAN_RFKILL]: wlan_platdata_parse_dt: enable wifi power control.
[    0.619878] [WLAN_RFKILL]: wlan_platdata_parse_dt: wifi power controled by gpio.
[    0.619916] [WLAN_RFKILL]: wlan_platdata_parse_dt: WIFI,host_wake_irq = 3, flags = 0.
[    0.619928] [WLAN_RFKILL]: wlan_platdata_parse_dt: The ref_wifi_clk not found !
[    0.619936] [WLAN_RFKILL]: rfkill_wlan_probe: init gpio
[    0.619943] [WLAN_RFKILL]: rfkill_set_wifi_bt_power: 1
[    0.619949] [WLAN_RFKILL]: Exit rfkill_wlan_probe
[    0.620254] [BT_RFKILL]: bluetooth_platdata_parse_dt: get property: uart_rts_gpios = 83.
[    0.620278] [BT_RFKILL]: bluetooth_platdata_parse_dt: get property: BT,reset_gpio = 9.
[    0.620294] [BT_RFKILL]: bluetooth_platdata_parse_dt: get property: BT,wake_gpio = 90.
[    0.620309] [BT_RFKILL]: bluetooth_platdata_parse_dt: get property: BT,wake_host_irq = 4.
[    0.620359] [BT_RFKILL]: Request irq for bt wakeup host
[    0.620434] [BT_RFKILL]: ** disable irq
[    0.620546] [BT_RFKILL]: bt_default device registered.
[    0.621860] registered taskstats version 1
[    0.621872] Loading compiled-in X.509 certificates
[    0.622007] Key type ._fscrypt registered
[    0.622016] Key type .fscrypt registered
[    0.622024] Key type fscrypt-provisioning registered
[    0.622268] pstore: Using compression: deflate
[    0.622957] rga: rga2_irq, irq = 46, match scheduler
[    0.623300] rga: Driver loaded successfully rga[3] ver:3.2.18218
[    0.623381] rga: probe successfully
[    0.623638] rga: Module initialized. v1.2.4
[    0.626842] mmc2: new HS400 Enhanced strobe MMC card at address 0001
[    0.627525] mmcblk2: mmc2:0001 AJTD4R 14.6 GiB
[    0.628147] mmcblk2boot0: mmc2:0001 AJTD4R partition 1 4.00 MiB
[    0.628854] mmcblk2boot1: mmc2:0001 AJTD4R partition 2 4.00 MiB
[    0.629111] mmcblk2rpmb: mmc2:0001 AJTD4R partition 3 4.00 MiB, chardev (237:0)
[    0.631474]  mmcblk2: p1 p2 p3 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14
[    0.646970] phy phy-ff770000.syscon:usb2-phy@e450.1: Linked as a consumer to regulator.2
[    0.647466] phy phy-ff770000.syscon:usb2-phy@e450.2: No vbus specified for otg port
[    0.648875] phy phy-ff770000.syscon:usb2-phy@e460.3: Linked as a consumer to regulator.2
[    0.649334] phy phy-ff770000.syscon:usb2-phy@e460.4: No vbus specified for otg port
[    0.651396] panel-simple edp-panel: Linked as a consumer to regulator.21
[    0.651429] panel-simple edp-panel: edp-panel supply vsp not found, using dummy regulator
[    0.651464] panel-simple edp-panel: Linked as a consumer to regulator.0
[    0.651478] panel-simple edp-panel: edp-panel supply vsn not found, using dummy regulator
[    0.651853] midgard ff9a0000.gpu: Linked as a consumer to regulator.7
[    0.651897] midgard ff9a0000.gpu: leakage=21
[    0.666359] midgard ff9a0000.gpu: temp=31666, pvtm=122849 (123309 + -460)
[    0.669679] midgard ff9a0000.gpu: pvtm-volt-sel=1
[    0.670082] midgard ff9a0000.gpu: avs=0
[    0.670599] midgard ff9a0000.gpu: GPU identified as 0x0860 r2p0 status 0
[    0.670706] midgard ff9a0000.gpu: Protected mode not available
[    0.671072] midgard ff9a0000.gpu: l=0 h=2147483647 hyst=5000 l_limit=0 h_limit=0 h_table=0
[    0.671119] midgard ff9a0000.gpu: Using configured power model mali-simple-power-model, and fallback mali-simple-power-model
[    0.671207] I : [File] : drivers/gpu/arm/midgard/backend/gpu/mali_kbase_devfreq.c; [Line] : 417; [Func] : midgard_kbase_devfreq_init(); success initing power_model_simple.
[    0.671759] midgard ff9a0000.gpu: Probed as mali0
[    0.672239] dwc3 fe800000.dwc3: Failed to get clk 'ref': -2
[    0.678226] dwc3 fe900000.dwc3: Failed to get clk 'ref': -2
[    0.681926] xhci-hcd xhci-hcd.1.auto: xHCI Host Controller
[    0.682188] xhci-hcd xhci-hcd.1.auto: new USB bus registered, assigned bus number 1
[    0.682666] xhci-hcd xhci-hcd.1.auto: hcc params 0x0220fe64 hci version 0x110 quirks 0x0000009002030010
[    0.682725] xhci-hcd xhci-hcd.1.auto: irq 65, io mem 0xfe900000
[    0.683001] usb usb1: New USB device found, idVendor=1d6b, idProduct=0002, bcdDevice= 4.19
[    0.683013] usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.683023] usb usb1: Product: xHCI Host Controller
[    0.683032] usb usb1: Manufacturer: Linux 4.19.232 xhci-hcd
[    0.683041] usb usb1: SerialNumber: xhci-hcd.1.auto
[    0.683428] hub 1-0:1.0: USB hub found
[    0.683459] hub 1-0:1.0: 1 port detected
[    0.683666] xhci-hcd xhci-hcd.1.auto: xHCI Host Controller
[    0.683809] xhci-hcd xhci-hcd.1.auto: new USB bus registered, assigned bus number 2
[    0.683827] xhci-hcd xhci-hcd.1.auto: Host supports USB 3.0 SuperSpeed
[    0.683878] usb usb2: We don't know the algorithms for LPM for this host, disabling LPM.
[    0.683964] usb usb2: New USB device found, idVendor=1d6b, idProduct=0003, bcdDevice= 4.19
[    0.683975] usb usb2: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.683984] usb usb2: Product: xHCI Host Controller
[    0.683993] usb usb2: Manufacturer: Linux 4.19.232 xhci-hcd
[    0.684002] usb usb2: SerialNumber: xhci-hcd.1.auto
[    0.684255] hub 2-0:1.0: USB hub found
[    0.684282] hub 2-0:1.0: 1 port detected
[    0.686958] ehci-platform fe380000.usb: EHCI Host Controller
[    0.687206] ehci-platform fe380000.usb: new USB bus registered, assigned bus number 3
[    0.687550] ehci-platform fe380000.usb: irq 28, io mem 0xfe380000
[    0.698875] ehci-platform fe380000.usb: USB 2.0 started, EHCI 1.00
[    0.699067] usb usb3: New USB device found, idVendor=1d6b, idProduct=0002, bcdDevice= 4.19
[    0.699080] usb usb3: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.699090] usb usb3: Product: EHCI Host Controller
[    0.699099] usb usb3: Manufacturer: Linux 4.19.232 ehci_hcd
[    0.699108] usb usb3: SerialNumber: fe380000.usb
[    0.699618] hub 3-0:1.0: USB hub found
[    0.699650] hub 3-0:1.0: 1 port detected
[    0.702042] ehci-platform fe3c0000.usb: EHCI Host Controller
[    0.702304] ehci-platform fe3c0000.usb: new USB bus registered, assigned bus number 4
[    0.702797] ehci-platform fe3c0000.usb: irq 30, io mem 0xfe3c0000
[    0.715469] ehci-platform fe3c0000.usb: USB 2.0 started, EHCI 1.00
[    0.715648] usb usb4: New USB device found, idVendor=1d6b, idProduct=0002, bcdDevice= 4.19
[    0.715660] usb usb4: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.715673] usb usb4: Product: EHCI Host Controller
[    0.715683] usb usb4: Manufacturer: Linux 4.19.232 ehci_hcd
[    0.715692] usb usb4: SerialNumber: fe3c0000.usb
[    0.716179] hub 4-0:1.0: USB hub found
[    0.716211] hub 4-0:1.0: 1 port detected
[    0.716824] ohci-platform fe3a0000.usb: Generic Platform OHCI controller
[    0.717055] ohci-platform fe3a0000.usb: new USB bus registered, assigned bus number 5
[    0.717313] ohci-platform fe3a0000.usb: irq 29, io mem 0xfe3a0000
[    0.776672] usb usb5: New USB device found, idVendor=1d6b, idProduct=0001, bcdDevice= 4.19
[    0.776744] usb usb5: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.776767] usb usb5: Product: Generic Platform OHCI controller
[    0.776789] usb usb5: Manufacturer: Linux 4.19.232 ohci_hcd
[    0.776811] usb usb5: SerialNumber: fe3a0000.usb
[    0.777988] hub 5-0:1.0: USB hub found
[    0.778100] hub 5-0:1.0: 1 port detected
[    0.779578] ohci-platform fe3e0000.usb: Generic Platform OHCI controller
[    0.780102] ohci-platform fe3e0000.usb: new USB bus registered, assigned bus number 6
[    0.780522] ohci-platform fe3e0000.usb: irq 31, io mem 0xfe3e0000
[    0.796733] vendor storage:20190527 ret = 0
[    0.839942] usb usb6: New USB device found, idVendor=1d6b, idProduct=0001, bcdDevice= 4.19
[    0.840028] usb usb6: New USB device strings: Mfr=3, Product=2, SerialNumber=1
[    0.840053] usb usb6: Product: Generic Platform OHCI controller
[    0.840075] usb usb6: Manufacturer: Linux 4.19.232 ohci_hcd
[    0.840096] usb usb6: SerialNumber: fe3e0000.usb
[    0.841238] hub 6-0:1.0: USB hub found
[    0.841358] hub 6-0:1.0: 1 port detected
[    0.842916] input: adc-keys as /devices/platform/adc-keys/input/input3


下面是ddr变频的初始化，DDR变频依赖CPU变频，如果cpu变频异常就会导致ddr变频失败，会出现错误log：rockchip-dmc dmc: cpu1 policy NULL，这里也可能是cpu2/3/4/5/6/7。
cpu编译异常一般是cpu供电异常，可以先检查上面uboot阶段提到cpu大核的供电log是否正常，如果不是800000uv就需要查硬件给cpu供电的DCDC


[    0.844495] rockchip-dmc dmc: Linked as a consumer to regulator.5
[    0.844592] rockchip-dmc dmc: Failed to get ddr_leakage
[    0.845091] rockchip-dmc dmc: avs=0
[    0.845386] rockchip-dmc dmc: failed to get vop pn to msch rl
[    0.845723] rockchip-dmc dmc: l=-2147483648 h=2147483647 hyst=0 l_limit=0 h_limit=0 h_table=0
[    0.845817] rockchip-dmc dmc: could not find power_model node
[    0.904171] asoc-simple-card es8316-sound: ES8316 HiFi <-> ff880000.i2s mapping ok
[    0.904256] asoc-simple-card es8316-sound: ASoC: no source widget found for MICBIAS1
[    0.904271] asoc-simple-card es8316-sound: ASoC: Failed to add route MICBIAS1 -> direct -> Mic Jack
[    0.904286] asoc-simple-card es8316-sound: ASoC: no sink widget found for IN1P
[    0.904298] asoc-simple-card es8316-sound: ASoC: Failed to add route Mic Jack -> direct -> IN1P
[    0.909054] phy phy-ff770000.syscon:usb2-phy@e450.2: charger = USB_SDP_CHARGER
[    0.919189] rockchip-drm display-subsystem: devfreq is ready
[    0.919417] rockchip-vop ff8f0000.vop: missing rockchip,grf property
[    0.919570] rockchip-drm display-subsystem: bound ff8f0000.vop (ops vop_component_ops)
[    0.919631] rockchip-vop ff900000.vop: missing rockchip,grf property
[    0.919777] rockchip-drm display-subsystem: bound ff900000.vop (ops vop_component_ops)
[    0.919825] rockchip-dp ff970000.edp: no DP phy configured
[    0.920526] rockchip-drm display-subsystem: bound ff970000.edp (ops rockchip_dp_component_ops)
[    0.920700] dwhdmi-rockchip ff940000.hdmi: Detected HDMI TX controller v2.11a with HDCP (DWC HDMI 2.0 TX PHY)
[    0.921496] dwhdmi-rockchip ff940000.hdmi: registered DesignWare HDMI I2C bus driver
[    0.923019] rockchip-drm display-subsystem: bound ff940000.hdmi (ops dw_hdmi_rockchip_ops)
[    0.923047] [drm] Supports vblank timestamp caching Rev 2 (21.10.2013).
[    0.923063] [drm] No driver support for vblank timestamp query.
[    0.923318] rockchip-drm display-subsystem: failed to parse loader memory
[    1.065385] rockchip-vop ff8f0000.vop: [drm:vop_crtc_atomic_enable] Update mode to 1536x2048p60, type: 14
[    1.067036] rockchip-drm display-subsystem: fb0:  frame buffer device
[    1.068251] [drm] Initialized rockchip 2.0.0 20140818 for display-subsystem on minor 0
[    1.070596] input: gpio-keys as /devices/platform/gpio-keys/input/input4
[    1.071906] It doesn't contain Rogue gpu
[    1.072351] cfg80211: Loading compiled-in X.509 certificates for regulatory database
[    1.073238] cfg80211: Loaded X.509 cert 'sforshee: 00b28ddf47aef9cea7'
[    1.073332] platform regulatory.0: Direct firmware load for regulatory.db failed with error -2
[    1.073343] cfg80211: failed to load regulatory.db
[    1.074554] I : [File] : drivers/gpu/arm/mali400/mali/linux/mali_kernel_linux.c; [Line] : 417; [Func] : mali_module_init(); svn_rev_string_from_arm of this mali_ko is '', rk_ko_ver is '5', built at '15:34:31', on 'Oct 26 2022'.
[    1.074772] Mali:
[    1.074774] Mali device driver loaded
[    1.074921] ALSA device list:
[    1.074936]   #0: rockchip,es8316-codec
[    1.078286] Freeing unused kernel memory: 3968K

```

## Init

```txt

[    1.078392] Run /init as init process
[    1.088095] init: init first stage started!
[    1.088231] init: Unable to open /lib/modules, skipping module loading.
[    1.089229] init: Using Android DT directory /proc/device-tree/firmware/android/
[    1.180122] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.181502] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.182873] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.184243] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.184447] init: bool android::init::BlockDevInitializer::InitDevices(std::set<std::string>): partition(s) not found in /sys, waiting for their uevent(s): system, vendor
[    1.185637] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.187009] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.188379] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.189749] rockchip-dp ff970000.edp: AUX CH error happened: 0x2 (1)
[    1.364553] [drm:analogix_dp_bridge_enable] *ERROR* dp commit error, ret = -121
[    1.666832] [drm:analogix_dp_bridge_enable] *ERROR* dp commit error, ret = -121
[    2.269260] [drm:analogix_dp_bridge_enable] *ERROR* dp commit error, ret = -121
[   11.185897] init: Wait for partitions returned after 10001ms
[   11.185986] init: bool android::init::BlockDevInitializer::InitDevices(std::set<std::string>): partition(s) not found after polling timeout: system, vendor
[   11.186137] init: Failed to mount required partitions early ...
[   11.186968] init: InitFatalReboot: signal 6
[   11.203040] init: #00 pc 0000000000304068  /init (UnwindStackCurrent::UnwindFromContext(unsigned long, void*)+96)
[   11.203080] init: #01 pc 0000000000274ed8  /init (android::init::InitFatalReboot(int)+208)
[   11.203101] init: #02 pc 00000000002752c0  /init (android::init::InstallRebootSignalHandlers()::$_22::__invoke(int)+32)
[   11.203120] init: #03 pc 00000000000005c0  [vdso:0000007fa61e6000] (__kernel_rt_sigreturn)
[   11.203136] init: #04 pc 0000000000378ba0  /init (abort+176)
[   11.203153] init: #05 pc 0000000000277c44  /init (android::init::InitAborter(char const*)+44)
[   11.203243] cpu cpu4: min=816000, max=816000
[   11.211423] cpu cpu0: min=816000, max=816000
[   11.268471] I : [File] : drivers/gpu/arm/midgard/platform/rk/mali_kbase_config_rk.c; [Line] : 274; [Func] : midgard_kbase_platform_rk_shutdown(); to make vdd_gpu enabled for turning off pd_gpu in pm_framework.
[   11.273193] fan53555-regulator 0-0041: fan53555..... reset
[   11.275014] fan53555-regulator 0-0041: reset: force fan53555_reset ok!
[   11.275680] fan53555-regulator 0-0040: fan53555..... reset
[   11.277480] fan53555-regulator 0-0040: reset: force fan53555_reset ok!
[   11.278357] mpp_vepu2 ff650000.vepu: shutdown device
[   11.278862] mpp_vdpu2 ff650400.vdpu: shutdown device
[   11.279312] mpp_rkvdec ff660000.rkvdec: shutdown device
[   11.280862] reboot: Restarting system with command 'bootloader'

```








