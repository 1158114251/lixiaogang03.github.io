---
layout:     post
title:      Android系统启动
subtitle:   System Boot Process
date:       2020-12-22
author:     LXG
header-img: img/post-bg-miui-ux.jpg
catalog: true
tags:
    - android
---

[Android启动流程-简书](https://www.jianshu.com/p/9f978d57c683)

## 框架图

![system_boot](/images/init/system_boot.png)

## BootLoader

从Power键上电到U-boot流程

![bootloader](/images/init/bootloader.png)


当uboot(fastboot)被装载后便开始运行，它一般会先检测用户是否按下某些特别按键，这些特别按键是uboot在编译时预先被约定好的，用于进入调试模式。
如果用户没有按这些特别的按键，则uboot会从NAND Flash中装载Linux内核，装载的地址是在编译uboot时预先约定好的。

## Kernel

**自解压过程**

kernel/msm-4.19/arch/arm/boot/compressed

**Linux初始化**

1. 设置体系结构相关的环境
2. 初始化内存结构
3. 开启MMU、建立页表
4. 创建异常向量表和初始化中断处理函数
5. 初始化系统核心进程调度器和时钟中断处理程序
6. 初始化串口控制台
7. 创建初始化系统cache
8. 初始化内存管理
9. 初始化系统的进程间通信机制
10. 挂载根文件系统

**Init启动**

1. 启动init服务 /bin/init  /etc/init
2. 启动udev
3. 设置内核参数
4. 设置系统时间
5. 启动交换内存空间
6. 检查并挂载所有文件系统
7. 初始化硬件设备
8. 初始化串行端口设备
9. 建立用户接口
10. 建立虚拟控制台







