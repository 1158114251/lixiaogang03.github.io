---
layout:     post
title:      RK3288 Camera
subtitle:   Android 7.1
date:       2022-03-30
author:     LXG
header-img: img/post-bg-android.jpg
catalog: true
tags:
    - camera
---

[rk-camera-tech](https://intgyl.com/categories/Linux/rockchip/camera/)

## 架构

![camera_arch](/images/kernel/camera_arch.jpg)

## 基础

相机模组组成：

1. 镜头 LENS
2. 对焦马达 VCM
3. 图像传感器 SENOSOR
4. 图像信号处理器 ISP

![camera_conception](/images/kernel/camera_conception.jpg)

按接口来划分，Camera 分为 DVP 、 MIPI、usb camera。
* DVP是并口，需要PCLK、VSYNC、HSYNC、D[0：11]——可以是8/10/12bit数据，看 ISP 或 baseband 是否支持；
* MIPI是LVDS，低压差分串口。只需要要CLKP/N、DATAP/N——最大支持4-lane，一般2-lane可以搞定。
* usb camera 相当于集 sensor、isp 驱动于一身的消息通，通过 usb 接口对外提供 YUV、MJpeg 等图像数据。

MIPI接口比DVP的接口信号线少，由于是低压差分信号，产生的干扰小，抗干扰能力也强。最重要的是 DVP 接口在信号完整性方面受限制，速率也受限制。500W还可以勉强用DVP，800W及以上都采用MIPI接口。
USB摄像头，即插即用比较灵活，但是由于传输速率的瓶颈，其支持分辨率较低。

## App

frameworks/base/core/java/android/hardware/Camera.java

**system/lib/libandroid_runtime.so**

frameworks/base/core/jni/android_hardware_Camera.cpp

**system/lib/libcamera_client.so**

frameworks/av/camera/Camera.cpp

frameworks/av/camera/CameraBase.cpp

## mediaserver

**/system/bin/mediaserver**

frameworks/av/media/mediaserver/main_mediaserver.cpp

**system/lib/libcameraservice.so**

frameworks/av/services/camera/libcameraservice/CameraService.cpp

## HAL

**system/lib/hw/camera.rk30board.so**

hardware/rockchip/camera/CameraHal/

## Driver

drivers/media/video

![v4l2_driver](/images/kernel/v4l2_driver.jpg)





