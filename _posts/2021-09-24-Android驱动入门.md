---
layout:     post
title:      Android 驱动入门
subtitle:   Android Driver
date:       2021-09-24
author:     LXG
header-img: img/post-bg-android.jpg
catalog: true
tags:
    - android
---

[液晶显示器](https://www.jianshu.com/p/13f83ae2ebba)

[LCD液晶屏驱动详解](https://www.jianshu.com/p/dcde66c1b5c5)

## 液晶显示器

![screen_driver](/images/screen_driver.webp)

调试LCD显示屏的过程，实际上就是调试发送端和接收端IC的过程

TFT-LCD常用的接口，TTL（RGB）、LVDS、EDP、MIPI

## Linux设备分类

* 字符设备-c
* 块设备-b
* 网络设备

```txt

ls -al dev/
crwxrwxrwx root     root     251,   3 2021-01-01 08:07 ttyS3


ls -al dev/block/
drwxr-xr-x root     root              2021-01-01 08:07 by-name
brw------- root     root     179,   0 2021-01-01 08:07 mmcblk0
brw------- system   system   179,   8 2021-01-01 08:07 mmcblk0p8
brw------- root     root     179,   9 2021-01-01 08:07 mmcblk0p9
drwxr-xr-x root     root              2021-01-01 08:07 platform
drwx------ root     root              2021-01-01 08:07 vold
brw------- root     root     253,   0 2021-01-01 08:07 zram0

```

## Android 专用驱动

### Ashmem: 匿名共享内存驱动

./kernel/drivers/staging/android/ashmem.c

```txt

ls -al dev/ashmem
crw-rw-rw- root     root      10,  51 2021-01-01 08:07 ashmem

```

### Logger: 轻量级log驱动

drivers/staging/android/logger.c

```txt

ls -al dev/log/
crw-rw-rw- root     log       10,  49 2021-01-01 08:07 events
crw-rw-rw- root     log       10,  50 2021-01-01 08:07 main
crw-rw-rw- root     log       10,  48 2021-01-01 08:07 radio
crw-rw-rw- root     log       10,  47 2021-01-01 08:07 system

```

![logger_system](/images/logcat/logger_system.png)

### Binder驱动

drivers/staging/android/binder.c

```txt

ls -al dev/binder
crw-rw-rw- root     root      10,  52 2021-01-01 08:07 binder

```

## 设备驱动

### 显示驱动

drivers/video/fbmem.c

```txt

crw------- root     root     247,   0 2021-01-01 08:07 lcd

ls -al dev/graphics/*
crw-rw---- system   system    29,   0 2021-01-01 08:00 fb0
crw-rw---- system   system    29,   1 2021-01-01 08:00 fb1
crw-rw---- root     graphics  29,   2 2021-01-01 08:00 fb2
crw-rw---- root     graphics  29,   3 2021-01-01 08:00 fb3
crw-rw---- root     graphics  29,   4 2021-01-01 08:00 fb4
crw-rw---- root     graphics  29,   5 2021-01-01 08:00 fb5
crw-rw---- root     graphics  29,   6 2021-01-01 08:00 fb6
crw-rw---- root     graphics  29,   7 2021-01-01 08:00 fb7


```

### 输入

drivers/input/input.c

```txt

ls -al dev/input/
crw-rw---- root     input     13,  64 2021-01-01 08:00 event0
crw-rw---- root     input     13,  65 2021-01-01 08:00 event1
crw-rw---- root     input     13,  66 2021-01-01 08:00 event2
crw-rw---- root     input     13,  67 2021-01-01 08:00 event3
crw-rw---- root     input     13,  68 2021-01-01 08:00 event4
crw-rw---- root     input     13,  63 2021-01-01 08:00 mice
crw-rw---- root     input     13,  32 2021-01-01 08:00 mouse0

```

### 摄像头驱动

drivers/media/video/v4l2-dev.c

```txt

ls -al dev/video0
crw-rw-rw- media    media     81,   0 2021-01-01 08:00 video0

```

### 音频驱动

```txt

ls -al dev/snd/*
crw-rw---- system   audio    116,   0 2021-01-01 08:00 controlC0
crw-rw---- media    media    116,  24 2021-01-01 08:00 pcmC0D0c
crw-rw---- media    media    116,  16 2021-01-01 08:00 pcmC0D0p
crw-rw---- system   audio    116,  33 2021-01-01 08:00 timer

```

### Flash驱动

```txt

ls dev/block/
by-name
loop0
loop1
loop2
loop3
loop4
loop5
loop6
loop7
mmcblk0
mmcblk0boot0
mmcblk0boot1
mmcblk0p1
mmcblk0p10
mmcblk0p11
mmcblk0p12
mmcblk0p2
mmcblk0p3
mmcblk0p5
mmcblk0p6
mmcblk0p7
mmcblk0p8
mmcblk0p9
platform
vold
zram0

```

### 蓝牙驱动

蓝牙设备是网络设备，使用网络接口

./drivers/bluetooth

### WLAN 驱动

WLAN设备是网络设备，使用网络接口

drivers/net/

### USB 驱动

```txt

ls -al dev/usb*
lrwxrwxrwx root     root              2021-01-01 08:00 input1-1.5 -> /dev/input/event2
lrwxrwxrwx root     root              2021-01-01 08:00 tty1-1.1 -> /dev/ttyUSB0
crw-rw---- root     usb       10,  54 2021-01-01 08:00 usb_accessory

```

## 驱动模块的加载

lsmod 命令列出了当前系统中加载的模块

```txt
Module           Size      Used by
sunxi_schw       12559     0 - Live 0x00000000 (O)
cdc_ether        5099      0 - Live 0x00000000
rtl8152          37073     0 - Live 0x00000000
mcs7830          6292      0 - Live 0x00000000
qf9700           7805      0 - Live 0x00000000
asix             17150     0 - Live 0x00000000
usbnet           17692     4 cdc_ether,mcs7830,qf9700,asix, Live 0x00000000
sunxi_keyboard   3021      0 - Live 0x00000000
gt9xx_ts         28934     0 - Live 0x00000000
gc0328           11137     0 - Live 0x00000000
vfe_v4l2         445432    0 - Live 0x00000000
vfe_subdev       4523      2 gc0328,vfe_v4l2, Live 0x00000000
vfe_os           3951      2 vfe_v4l2,vfe_subdev, Live 0x00000000
cci              21738     1 gc0328, Live 0x00000000
videobuf_dma_contig 5567   1 vfe_v4l2, Live 0x00000000
videobuf_core    16520     2 vfe_v4l2,videobuf_dma_contig, Live 0x00000000
leds_sunxi       1359      0 - Live 0x00000000
mali             212802    15 - Live 0x00000000 (O)
lcd              69452     0 - Live 0x00000000
disp             992848    8 mali,lcd, Live 0x00000000
nand             280194    0 - Live 0x00000000 (O)

```








